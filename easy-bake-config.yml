library_core:
  join: mixin-js-core.js
  compress: true
  files:
    - src/mixin-core.coffee
    - src/mixin-core-statistics.coffee

library:
  join: mixin-js.js
  compress: true
  files:
    - src/mixin-core.coffee
    - src/mixin-core-statistics.coffee
    - src/lib/**.*coffee

library_individual_mixins:
  output: ../../lib
  compress: true
  directories:
    - src/lib

tests:
  output: build
  directories:
    - test/core
    - test/integration-auto-unmix
    - test/mixin-auto-memory
    - test/mixin-flags
    - test/mixin-ref-count
    - test/mixin-subscriptions
    - test/mixin-timeouts
    - test/packaging
  modes:
    build:
      bundles:
        test/packaging/build/bundle-bundled.js:
          underscore: vendor/underscore-latest.js
          mixin-js: mixin-js.js
        test/packaging/build/bundle-unbundled.js:
          underscore: vendor/underscore-latest.js
          mixin-js-core: mixin-js-core.js
          mixin-js-auto-memory: lib/mixin-js-auto-memory.js
          mixin-js-flags: lib/mixin-js-flags.js
          mixin-js-ref-count: lib/mixin-js-ref-count.js
          mixin-js-subscriptions: lib/mixin-js-subscriptions.js
          mixin-js-timeouts: lib/mixin-js-timeouts.js
      no_files_ok: ['test/packaging']
    test:
      command: phantomjs
      runner: phantomjs-qunit-runner.js
      files:
        - '**/*.html'

postinstall:
  commands:
    - 'cp underscore vendor/underscore-latest.js'